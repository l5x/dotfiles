#!/usr/bin/env bash
#
# @description build irssi chat client
#
# @import console/info
# @dependency git

main () {
    strict  true
    verbose true

    # apt-get install build-essential automake autoconf libtool lynx libglib2.0-dev

    if [[ -d "${HOME}/.irssi-dist" ]]
    then
        rm -rf "${HOME}/.irssi-dist"
    fi 

    mkdir -p "${HOME}/.irssi-dist/build"

    git clone --depth 1 https://github.com/irssi/irssi.git "${HOME}/.irssi-dist/build"

    cd "${HOME}/.irssi-dist/build" || exit

    # ./autogen.sh
    # --with-python-config-dir="$HOME/.pyenv/versions/2.7.11/lib/python2.7/config" \
    "${HOME}/.irssi-dist/build/autogen.sh" \
            --with-socks \
            --with-perl=yes \
            --prefix="${HOME}/.irssi-dist"

    make -j 4
    make install

    _ info "Done."
}

onExit () {
    _ info "Removing temporary files and directories."

    if [[ -d "${HOME}/.irssi-dist/build" ]]
    then
        rm -rf "${HOME}/.irssi-dist/build"
    fi 
}
