#!/usr/bin/env bash
# @description build X command-line utilities
#
# @import console/info
# @dependency git

main () {
    strict  true
    verbose true

    if [[ -d "${HOME}/.xutils-dist" ]]
    then
        rm -rf "${HOME}/.xutils-dist"
    fi 

    mkdir -p "${HOME}/.xutils-dist/build"

    git clone --depth 1 https://github.com/baskerville/sutils.git  "${HOME}/.xutils-dist/build"

    cd "${HOME}/.xutils-dist/build" || exit

    PREFIX="${HOME}/.xutils-dist" make -j 2
    PREFIX="${HOME}/.xutils-dist" make install

    cd / || exit

    if [[ -d "${HOME}/.xutils-dist/build" ]]
    then
        rm -rf "${HOME}/.xutils-dist/build"
    fi

    git clone --depth 1 https://github.com/baskerville/xtitle.git  "${HOME}/.xutils-dist/build"

    cd "${HOME}/.xutils-dist/build" || exit

    PREFIX="${HOME}/.xutils-dist" make -j 2
    PREFIX="${HOME}/.xutils-dist" make install

    cd / || exit

    if [[ -d "${HOME}/.xutils-dist/build" ]]
    then
        rm -rf "${HOME}/.xutils-dist/build"
    fi

    git clone --depth 1 https://github.com/krypt-n/bar.git  "${HOME}/.xutils-dist/build"

    cd "${HOME}/.xutils-dist/build" || exit

    PREFIX="${HOME}/.xutils-dist" make
    PREFIX="${HOME}/.xutils-dist" make install

    _ info "Done."
}

onExit () {
    _ info "Removing temporary files and directories."

    if [[ -d "${HOME}/.xutils-dist/build" ]]
    then
        rm -rf "${HOME}/.xutils-dist/build"
    fi 
}
